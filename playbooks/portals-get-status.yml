- name: Get Skynet Webportals status
  hosts: webportals
  gather_facts: False

  # Load common vars
  vars_files:
  - vars/common.yml

  # Playbook specific vars
  vars:
    portal_action: "portal-get-status"

  tasks:

    - name: Include getting portal status
      include_tasks: tasks/portal-status-get-status.yml

- name: Report Skynet Webportals status to discord
  hosts: webportals
  gather_facts: False

  # Load common vars
  vars_files:
  - vars/common.yml
  
  # Limit concurrency to handle Discord webhook rate limits
  serial: 1

  tasks:

    - name: Include reporting status to Discord
      include_tasks: tasks/portal-status-report-to-discord.yml